{% extends "base_dashboard.html" %}

{% block title %}ุงูุฑุณุงุฆู{% endblock %}
{% block topbar_title %}ุงูุฑุณุงุฆู{% endblock %}

{% block sidebar_nav %}
<a href="{{ url_for('parent.dashboard') }}" class="sidebar-link">
    <span class="sidebar-icon">๐</span>
    <span>ุงูุฑุฆูุณูุฉ</span>
</a>
<a href="{{ url_for('parent.children') }}" class="sidebar-link">
    <span class="sidebar-icon">๐จโ๐งโ๐ฆ</span>
    <span>ุฃุจูุงุฆู</span>
</a>
<a href="{{ url_for('parent.messages') }}" class="sidebar-link active">
    <span class="sidebar-icon">โ๏ธ</span>
    <span>ุงูุฑุณุงุฆู</span>
</a>
{% endblock %}

{% block content %}
<div class="page-header">
    <h2 class="page-title">โ๏ธ ุงูุฑุณุงุฆู</h2>
    <p class="page-subtitle">ุชูุงุตู ูุน ูุนููู ุฃุจูุงุฆู ูุฅุฏุงุฑุฉ ุดูุจู ููุฑุณ</p>
</div>

<div class="dashboard-grid">
    <!-- ูุงุฆูุฉ ุงููุญุงุฏุซุงุช -->
    <div class="dashboard-grid-main">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">ุงููุญุงุฏุซุงุช</h3>
                <button class="btn btn-sm btn-primary" id="newMessageBtn" disabled title="ูุฑูุจุง">
                    ุฑุณุงูุฉ ุฌุฏูุฏุฉ
                </button>
            </div>

            {% if messages %}
            <div style="display: flex; flex-direction: column;">
                {% for msg in messages %}
                <div style="display: flex; align-items: center; gap: var(--space-md); padding: var(--space-md); border-bottom: 1px solid var(--border-light); cursor: pointer; transition: background var(--transition-fast);"
                     onmouseover="this.style.background='var(--bg)'" onmouseout="this.style.background='transparent'">
                    <div class="avatar">
                        {{ msg.sender_name[0] if msg.sender_name else '?' }}
                    </div>
                    <div style="flex: 1; min-width: 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-xs);">
                            <span style="font-weight: var(--fw-bold); font-size: var(--text-sm);">{{ msg.sender_name or 'ูุฌููู' }}</span>
                            <span style="font-size: var(--text-xs); color: var(--text-muted);">{{ msg.sent_at.strftime('%Y-%m-%d %H:%M') if msg.sent_at else '' }}</span>
                        </div>
                        <div style="font-size: var(--text-sm); color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                            {{ msg.preview or msg.body or '' }}
                        </div>
                    </div>
                    {% if msg.unread %}
                    <div style="width: 10px; height: 10px; background: var(--sv-orange); border-radius: var(--radius-full); flex-shrink: 0;"></div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">โ๏ธ</div>
                <div class="empty-state-text">ูุง ุชูุฌุฏ ุฑุณุงุฆู ุญุงููุง</div>
                <p style="color: var(--text-muted); font-size: var(--text-sm);">ุณุชุธูุฑ ููุง ุงูุฑุณุงุฆู ูู ุงููุนูููู ูุงูุฅุฏุงุฑุฉ</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- ูุนูููุงุช ุฌุงูุจูุฉ -->
    <div class="dashboard-grid-aside">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">ูุนูููุงุช</h3>
            </div>
            <div style="font-size: var(--text-sm); color: var(--text-secondary); line-height: 1.8;">
                <p style="margin-bottom: var(--space-md);">
                    ุฎุฏูุฉ ุงููุฑุงุณูุฉ ุณุชุชูุญ ูู ุงูุชูุงุตู ุงููุจุงุดุฑ ูุน:
                </p>
                <ul style="padding-right: var(--space-lg); margin-bottom: var(--space-md);">
                    <li style="margin-bottom: var(--space-xs);">ูุนููู ุฃุจูุงุฆู</li>
                    <li style="margin-bottom: var(--space-xs);">ุฅุฏุงุฑุฉ ุดูุจู ููุฑุณ</li>
                    <li style="margin-bottom: var(--space-xs);">ูุฑูู ุงูุฏุนู ุงูููู</li>
                </ul>
                <div style="padding: var(--space-md); background: var(--info-light); border-radius: var(--radius-md); color: var(--info);">
                    ูุฐู ุงูุฎุงุตูุฉ ููุฏ ุงูุชุทููุฑ ูุณุชููู ูุชุงุญุฉ ูุฑูุจุง
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3 class="card-title">ุงูุฏุนู ุงูููู</h3>
            </div>
            <div style="font-size: var(--text-sm); color: var(--text-secondary); line-height: 1.8;">
                <p>ูู ุญุงู ูุฌูุฏ ุฃู ุงุณุชูุณุงุฑ ุนุงุฌูุ ููููู ุงูุชูุงุตู ุนุจุฑ:</p>
                <div style="margin-top: var(--space-md); padding: var(--space-md); background: var(--bg); border-radius: var(--radius-md);">
                    <div style="margin-bottom: var(--space-sm);">
                        <span style="font-weight: var(--fw-bold);">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</span>
                        <span style="direction: ltr;">support@shalabyverse.com</span>
                    </div>
                    <div>
                        <span style="font-weight: var(--fw-bold);">ูุงุชุณุงุจ:</span>
                        <span style="direction: ltr;">+20 XXX XXX XXXX</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
