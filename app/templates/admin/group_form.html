{% extends "base_dashboard.html" %}

{% block topbar_title %}{{ 'ุชุนุฏูู ุงููุฌููุนุฉ' if group is defined and group else 'ุฅูุดุงุก ูุฌููุนุฉ ุฌุฏูุฏุฉ' }}{% endblock %}

{% block sidebar_nav %}
<a class="sidebar-nav-item" href="{{ url_for('admin.dashboard') }}">๐ ููุญุฉ ุงูุชุญูู</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.users') }}">๐ฅ ุงููุณุชุฎุฏููู</a>
<a class="sidebar-nav-item active" href="{{ url_for('admin.groups') }}">๐ ุงููุฌููุนุงุช</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.sessions') }}">๐ ุงูุฌูุณุงุช</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.resources') }}">๐ ุงูููุงุฑุฏ</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.activities') }}">๐ฎ ุงูุฃูุดุทุฉ</a>
<a class="sidebar-nav-item" href="{{ url_for('curriculum.home') }}">๐ ุงููููุฌ</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.reports') }}">๐ ุงูุชูุงุฑูุฑ</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.settings') }}">โ๏ธ ุงูุฅุนุฏุงุฏุงุช</a>
{% endblock %}

{% block content %}
<div class="card" style="max-width:700px;">
    <form method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="form-group">
            <label class="form-label">ุงุณู ุงููุฌููุนุฉ *</label>
            <input type="text" name="name" class="form-input" value="{{ group.name if group is defined and group else '' }}" required>
        </div>
        <div class="form-group">
            <label class="form-label">ุงููุณุงุฑ</label>
            <select name="track_id" class="form-select">
                <option value="">โ ุงุฎุชุฑ ุงููุณุงุฑ โ</option>
                {% for t in tracks %}
                <option value="{{ t.id }}" {{ 'selected' if group is defined and group and group.track_id == t.id }}>{{ t.name_ar }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">ุงููุนูู</label>
            <select name="teacher_id" class="form-select">
                <option value="">โ ุงุฎุชุฑ ุงููุนูู โ</option>
                {% for t in teachers %}
                <option value="{{ t.id }}" {{ 'selected' if group is defined and group and group.teacher_id == t.id }}>{{ t.name_ar }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">ุงูุญุฏ ุงูุฃูุตู ููุทูุงุจ</label>
            <input type="number" name="max_students" class="form-input" value="{{ group.max_students if group is defined and group else 12 }}" min="1" max="50">
        </div>
        <div class="form-group">
            <label class="form-label">ุงูุทูุงุจ</label>
            <div style="max-height:200px;overflow-y:auto;border:1px solid var(--border);border-radius:var(--radius-md);padding:var(--space-sm);">
                {% for s in students %}
                <label style="display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-xs) var(--space-sm);cursor:pointer;">
                    <input type="checkbox" name="student_ids" value="{{ s.id }}" {{ 'checked' if current_student_ids is defined and s.id in current_student_ids }} style="accent-color:var(--sv-purple);">
                    {{ s.name_ar }} <span class="text-xs text-muted">({{ s.email }})</span>
                </label>
                {% endfor %}
            </div>
        </div>
        {% if group is defined and group %}
        <div class="form-group">
            <label style="display:flex;align-items:center;gap:var(--space-sm);cursor:pointer;">
                <input type="checkbox" name="is_active" {{ 'checked' if group.is_active }} style="accent-color:var(--sv-purple);">
                <span>ุงููุฌููุนุฉ ูุดุทุฉ</span>
            </label>
        </div>
        {% endif %}
        <div style="display:flex;gap:var(--space-md);">
            <button type="submit" class="btn btn-primary">{{ 'ุญูุธ ุงูุชุนุฏููุงุช' if group is defined and group else 'ุฅูุดุงุก ุงููุฌููุนุฉ' }}</button>
            <a href="{{ url_for('admin.groups') }}" class="btn btn-outline">ุฅูุบุงุก</a>
        </div>
    </form>
</div>
{% endblock %}
