{% extends "base_dashboard.html" %}

{% block topbar_title %}Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª{% endblock %}

{% block sidebar_nav %}
<a class="sidebar-nav-item" href="{{ url_for('admin.dashboard') }}">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.users') }}">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.groups') }}">ğŸ“š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</a>
<a class="sidebar-nav-item active" href="{{ url_for('admin.sessions') }}">ğŸ“ Ø§Ù„Ø¬Ù„Ø³Ø§Øª</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.resources') }}">ğŸ“ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯</a>
<a class="sidebar-nav-item" href="{{ url_for('curriculum.home') }}">ğŸ“– Ø§Ù„Ù…Ù†Ù‡Ø¬</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.reports') }}">ğŸ“ˆ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.settings') }}">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
{% endblock %}

{% block content %}
<div style="display:flex;gap:var(--space-sm);margin-bottom:var(--space-lg);">
    <a href="{{ url_for('admin.sessions') }}" class="btn {{ 'btn-primary' if not status_filter else 'btn-outline' }} btn-sm">Ø§Ù„ÙƒÙ„</a>
    <a href="{{ url_for('admin.sessions', status='scheduled') }}" class="btn {{ 'btn-primary' if status_filter=='scheduled' else 'btn-outline' }} btn-sm">Ù…Ø¬Ø¯ÙˆÙ„Ø©</a>
    <a href="{{ url_for('admin.sessions', status='live') }}" class="btn {{ 'btn-primary' if status_filter=='live' else 'btn-outline' }} btn-sm">Ù…Ø¨Ø§Ø´Ø±Ø©</a>
    <a href="{{ url_for('admin.sessions', status='completed') }}" class="btn {{ 'btn-primary' if status_filter=='completed' else 'btn-outline' }} btn-sm">Ù…ÙƒØªÙ…Ù„Ø©</a>
</div>

<div class="card">
    <table class="table">
        <thead>
            <tr><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</th><th>Ø§Ù„Ù…Ø¹Ù„Ù…</th><th>Ø§Ù„Ù…ÙˆØ¹Ø¯</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr>
        </thead>
        <tbody>
            {% for s in items %}
            <tr>
                <td style="font-weight:600;">{{ s.title }}</td>
                <td class="text-sm">{{ s.group.name if s.group else 'â€”' }}</td>
                <td class="text-sm">{{ s.teacher.name_ar if s.teacher else 'â€”' }}</td>
                <td class="text-sm">{{ s.scheduled_at.strftime('%Y-%m-%d %H:%M') if s.scheduled_at else 'â€”' }}</td>
                <td>
                    {% if s.status.value == 'live' %}
                    <span class="badge" style="background:var(--status-success-bg);color:var(--status-success);">Ù…Ø¨Ø§Ø´Ø±Ø©</span>
                    {% elif s.status.value == 'scheduled' %}
                    <span class="badge" style="background:var(--status-info-bg);color:var(--status-info);">Ù…Ø¬Ø¯ÙˆÙ„Ø©</span>
                    {% elif s.status.value == 'completed' %}
                    <span class="badge">Ù…ÙƒØªÙ…Ù„Ø©</span>
                    {% else %}
                    <span class="badge" style="background:var(--status-warning-bg);color:var(--status-warning);">{{ s.status.value }}</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('admin.session_detail', session_id=s.id) }}" class="btn btn-ghost btn-sm">ØªÙØ§ØµÙŠÙ„</a>
                    {% if s.status.value == 'scheduled' %}
                    <button onclick="startSession({{ s.id }})" class="btn btn-primary btn-sm">Ø¨Ø¯Ø¡</button>
                    {% elif s.status.value == 'live' %}
                    <button onclick="endSession({{ s.id }})" class="btn btn-outline btn-sm">Ø¥Ù†Ù‡Ø§Ø¡</button>
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr><td colspan="6" class="text-center text-muted" style="padding:var(--space-xl);">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬Ù„Ø³Ø§Øª</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if pages > 1 %}
<div class="pagination">
    {% for p in range(1, pages + 1) %}
    <a href="{{ url_for('admin.sessions', page=p, status=status_filter) }}" class="pagination-item {{ 'active' if p == page else '' }}">{{ p }}</a>
    {% endfor %}
</div>
{% endif %}
{% endblock %}

{% block dashboard_js %}
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
