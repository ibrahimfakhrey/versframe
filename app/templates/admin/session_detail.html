{% extends "base_dashboard.html" %}

{% block topbar_title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬Ù„Ø³Ø©{% endblock %}

{% block sidebar_nav %}
<a class="sidebar-nav-item" href="{{ url_for('admin.dashboard') }}">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.users') }}">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.groups') }}">ğŸ“š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</a>
<a class="sidebar-nav-item active" href="{{ url_for('admin.sessions') }}">ğŸ“ Ø§Ù„Ø¬Ù„Ø³Ø§Øª</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.resources') }}">ğŸ“ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.activities') }}">ğŸ® Ø§Ù„Ø£Ù†Ø´Ø·Ø©</a>
<a class="sidebar-nav-item" href="{{ url_for('curriculum.home') }}">ğŸ“– Ø§Ù„Ù…Ù†Ù‡Ø¬</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.reports') }}">ğŸ“ˆ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.settings') }}">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
{% endblock %}

{% block content %}
<div class="card" style="margin-bottom:var(--space-lg);">
    <h2 style="margin-bottom:var(--space-md);">{{ session.title }}</h2>
    <div class="stats-grid" style="grid-template-columns:repeat(auto-fill,minmax(160px,1fr));">
        <div class="stat-card"><div class="stat-card-label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</div><div style="font-weight:600;">{{ session.group.name if session.group else 'â€”' }}</div></div>
        <div class="stat-card"><div class="stat-card-label">Ø§Ù„Ù…Ø¹Ù„Ù…</div><div style="font-weight:600;">{{ session.teacher.name_ar if session.teacher else 'â€”' }}</div></div>
        <div class="stat-card"><div class="stat-card-label">Ø§Ù„Ù…ÙˆØ¹Ø¯</div><div style="font-weight:600;">{{ session.scheduled_at.strftime('%Y-%m-%d %H:%M') if session.scheduled_at else 'â€”' }}</div></div>
        <div class="stat-card"><div class="stat-card-label">Ø§Ù„Ù…Ø¯Ø©</div><div style="font-weight:600;">{{ session.duration_minutes }} Ø¯Ù‚ÙŠÙ‚Ø©</div></div>
        <div class="stat-card"><div class="stat-card-label">Ø§Ù„Ø­Ø§Ù„Ø©</div><div style="font-weight:600;">{{ session.status.value }}</div></div>
    </div>
</div>

{% if session.teacher_notes %}
<div class="card" style="margin-bottom:var(--space-lg);">
    <h3 style="margin-bottom:var(--space-sm);">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…</h3>
    <p>{{ session.teacher_notes }}</p>
</div>
{% endif %}

<div class="card">
    <h3 style="margin-bottom:var(--space-md);">Ø§Ù„Ø­Ø¶ÙˆØ±</h3>
    {% if session.attendance.all() %}
    <table class="table">
        <thead><tr><th>Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>ÙˆÙ‚Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</th><th>ÙˆÙ‚Øª Ø§Ù„Ø®Ø±ÙˆØ¬</th><th>Ø§Ù„Ù…Ø¯Ø©</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead>
        <tbody>
            {% for a in session.attendance.all() %}
            <tr>
                <td>{{ a.student.name_ar if a.student else 'â€”' }}</td>
                <td class="text-sm">{{ a.joined_at.strftime('%H:%M') if a.joined_at else 'â€”' }}</td>
                <td class="text-sm">{{ a.left_at.strftime('%H:%M') if a.left_at else 'â€”' }}</td>
                <td class="text-sm">{{ (a.duration_seconds // 60) }} Ø¯Ù‚ÙŠÙ‚Ø©</td>
                <td><span class="badge">{{ a.status.value }}</span></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state-inline">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø­Ø¶ÙˆØ± Ø¨Ø¹Ø¯</div>
    {% endif %}
</div>
{% endblock %}

{% block dashboard_js %}
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
