{% extends "base_dashboard.html" %}

{% block topbar_title %}Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±{% endblock %}

{% block sidebar_nav %}
<a class="sidebar-nav-item active" href="{{ url_for('admin.dashboard') }}">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.users') }}">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.groups') }}">ğŸ“š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.sessions') }}">ğŸ“ Ø§Ù„Ø¬Ù„Ø³Ø§Øª</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.resources') }}">ğŸ“ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯</a>
<a class="sidebar-nav-item" href="{{ url_for('curriculum.home') }}">ğŸ“– Ø§Ù„Ù…Ù†Ù‡Ø¬</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.reports') }}">ğŸ“ˆ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
<a class="sidebar-nav-item" href="{{ url_for('admin.settings') }}">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
{% endblock %}

{% block content %}
<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-card-value" data-count="{{ stats.total_users }}">{{ stats.total_users }}</div>
        <div class="stat-card-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
    </div>
    <div class="stat-card">
        <div class="stat-card-value" data-count="{{ stats.students }}">{{ stats.students }}</div>
        <div class="stat-card-label">Ø§Ù„Ø·Ù„Ø§Ø¨</div>
    </div>
    <div class="stat-card">
        <div class="stat-card-value" data-count="{{ stats.teachers }}">{{ stats.teachers }}</div>
        <div class="stat-card-label">Ø§Ù„Ù…Ø¹Ù„Ù…ÙˆÙ†</div>
    </div>
    <div class="stat-card">
        <div class="stat-card-value" data-count="{{ stats.groups }}">{{ stats.groups }}</div>
        <div class="stat-card-label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</div>
    </div>
    <div class="stat-card">
        <div class="stat-card-value" data-count="{{ stats.sessions_total }}">{{ stats.sessions_total }}</div>
        <div class="stat-card-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¬Ù„Ø³Ø§Øª</div>
    </div>
    <div class="stat-card" style="border-right-color:var(--status-success);">
        <div class="stat-card-value" data-count="{{ stats.sessions_live }}">{{ stats.sessions_live }}</div>
        <div class="stat-card-label">Ø¬Ù„Ø³Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø© Ø§Ù„Ø¢Ù†</div>
    </div>
    <div class="stat-card">
        <div class="stat-card-value" data-count="{{ stats.resources }}">{{ stats.resources }}</div>
        <div class="stat-card-label">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯</div>
    </div>
    <div class="stat-card">
        <div class="stat-card-value" data-count="{{ stats.parents }}">{{ stats.parents }}</div>
        <div class="stat-card-label">Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</div>
    </div>
</div>

<!-- Quick Actions -->
<div style="display:flex;gap:var(--space-md);flex-wrap:wrap;margin:var(--space-xl) 0;">
    <a href="{{ url_for('admin.user_create') }}" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</a>
    <a href="{{ url_for('admin.group_create') }}" class="btn btn-orange">+ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø©</a>
    <a href="{{ url_for('admin.resource_create') }}" class="btn btn-outline">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ±Ø¯</a>
</div>

<div class="two-col-grid">
    <!-- Recent Users -->
    <div class="card">
        <div class="card-header">
            <h3>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ø¬Ø¯Ø¯</h3>
            <a href="{{ url_for('admin.users') }}" class="btn btn-ghost btn-sm">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</a>
        </div>
        <div class="card-body">
            {% for u in recent_users %}
            <div class="activity-item">
                <div class="avatar avatar-sm">{{ u.name_ar[0] if u.name_ar else '?' }}</div>
                <div style="flex:1;">
                    <div style="font-weight:600;">{{ u.name_ar }}</div>
                    <div class="text-sm text-muted">{{ u.email }} â€” {{ u.role.value }}</div>
                </div>
            </div>
            {% else %}
            <div class="empty-state-inline">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¨Ø¹Ø¯</div>
            {% endfor %}
        </div>
    </div>

    <!-- Upcoming Sessions -->
    <div class="card">
        <div class="card-header">
            <h3>Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
            <a href="{{ url_for('admin.sessions') }}" class="btn btn-ghost btn-sm">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</a>
        </div>
        <div class="card-body">
            {% for s in upcoming_sessions %}
            <div class="activity-item">
                <div style="flex:1;">
                    <div style="font-weight:600;">{{ s.title }}</div>
                    <div class="text-sm text-muted">{{ s.group.name if s.group else 'â€”' }} | {{ s.scheduled_at.strftime('%Y-%m-%d %H:%M') if s.scheduled_at else 'â€”' }}</div>
                </div>
                <button onclick="startSession({{ s.id }})" class="btn btn-primary btn-sm">Ø¨Ø¯Ø¡</button>
            </div>
            {% else %}
            <div class="empty-state-inline">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬Ù„Ø³Ø§Øª Ù‚Ø§Ø¯Ù…Ø©</div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block dashboard_js %}
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
