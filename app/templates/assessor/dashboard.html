{% extends "base_dashboard.html" %}

{% block title %}Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù‚ÙŠÙ‘Ù…{% endblock %}
{% block topbar_title %}Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù‚ÙŠÙ‘Ù…{% endblock %}

{% block sidebar_nav %}
<a href="{{ url_for('assessor.dashboard') }}" class="sidebar-link active">
    <span class="sidebar-icon">ğŸ </span>
    <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
</a>
<a href="{{ url_for('assessor.assessments') }}" class="sidebar-link">
    <span class="sidebar-icon">ğŸ“‹</span>
    <span>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</span>
</a>
{% endblock %}

{% block content %}
<!-- ØªØ±Ø­ÙŠØ¨ -->
<div class="page-header">
    <h2 class="page-title">Ù…Ø±Ø­Ø¨Ø§ØŒ {{ current_user.name_ar }} ğŸ‘‹</h2>
    <p class="page-subtitle">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ù„Ø§Ø¨</p>
</div>

<!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="stats-grid">
    <div class="card stat-card">
        <div class="stat-icon" style="background: var(--sv-purple-glow); color: var(--sv-purple);">ğŸ“‹</div>
        <div>
            <div class="stat-value">{{ stats.total_assessments|default(0) }}</div>
            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div>
        </div>
    </div>
    <div class="card stat-card">
        <div class="stat-icon" style="background: var(--success-light); color: var(--success);">âœ…</div>
        <div>
            <div class="stat-value">{{ stats.completed|default(0) }}</div>
            <div class="stat-label">ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù…ÙƒØªÙ…Ù„Ø©</div>
        </div>
    </div>
    <div class="card stat-card">
        <div class="stat-icon" style="background: var(--warning-light); color: #856404;">â³</div>
        <div>
            <div class="stat-value">{{ stats.pending|default(0) }}</div>
            <div class="stat-label">ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</div>
        </div>
    </div>
    <div class="card stat-card">
        <div class="stat-icon" style="background: var(--sv-orange-glow); color: var(--sv-orange);">ğŸ“…</div>
        <div>
            <div class="stat-value">{{ upcoming_assessments|length }}</div>
            <div class="stat-label">ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù‚Ø§Ø¯Ù…Ø©</div>
        </div>
    </div>
</div>

<!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù„ÙˆØ­Ø© -->
<div class="dashboard-grid">
    <div class="dashboard-grid-main">
        <!-- Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© -->
        <div class="card" style="margin-bottom: var(--space-xl);">
            <div class="card-header">
                <h3 class="card-title">ğŸ“… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
                <a href="{{ url_for('assessor.assessments') }}" class="btn btn-sm btn-ghost">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</a>
            </div>

            {% if upcoming_assessments %}
            <div style="display: flex; flex-direction: column; gap: var(--space-sm);">
                {% for assessment in upcoming_assessments[:5] %}
                <a href="{{ url_for('assessor.assessment_detail', assessment_id=assessment.id) }}" style="text-decoration: none; color: inherit;">
                    <div class="session-card">
                        <div class="session-time">
                            <div class="session-time-hour">{{ assessment.scheduled_at.strftime('%H:%M') if assessment.scheduled_at else '--:--' }}</div>
                            <div class="session-time-period">{{ assessment.scheduled_at.strftime('%m/%d') if assessment.scheduled_at else '' }}</div>
                        </div>
                        <div class="session-info">
                            <div class="session-title">{{ assessment.student.name_ar if assessment.student else 'Ø·Ø§Ù„Ø¨' }}</div>
                            <div class="session-meta">ØªÙ‚ÙŠÙŠÙ…</div>
                        </div>
                        <span class="badge badge-info">Ù‚Ø§Ø¯Ù…</span>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state" style="padding: var(--space-xl);">
                <div class="empty-state-icon">ğŸ“…</div>
                <div class="empty-state-text">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù‚Ø§Ø¯Ù…Ø©</div>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="dashboard-grid-aside">
        <!-- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø®ÙŠØ±Ø© -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">ğŸ“Š Ø£Ø­Ø¯Ø« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h3>
            </div>
            {% if recent_reports %}
            <div class="activity-list">
                {% for report in recent_reports[:8] %}
                <div class="activity-item">
                    <div class="activity-icon" style="background: var(--sv-purple-glow); color: var(--sv-purple);">ğŸ“Š</div>
                    <div class="activity-text">
                        <div style="font-weight: var(--fw-bold);">{{ report.student.name_ar if report.student else 'Ø·Ø§Ù„Ø¨' }}</div>
                        <div style="font-size: var(--text-xs); color: var(--text-muted);">
                            {{ report.title or 'ØªÙ‚Ø±ÙŠØ± ØªÙ‚ÙŠÙŠÙ…' }}
                        </div>
                    </div>
                    <div class="activity-time">
                        {% if report.score is not none %}
                        <span class="badge badge-purple" style="font-size: 10px;">{{ report.score }}%</span>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div style="text-align: center; color: var(--text-muted); font-size: var(--text-sm); padding: var(--space-lg);">
                Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†
            </div>
            {% endif %}
        </div>

        <!-- Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø© -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
            </div>
            <div style="display: flex; flex-direction: column; gap: var(--space-sm);">
                <a href="{{ url_for('assessor.assessments') }}" class="btn btn-block btn-outline" style="justify-content: flex-start;">
                    ğŸ“‹ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
